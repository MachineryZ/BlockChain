# 比特币的共识协议

央行发行的货币：
1. 防伪标识
2. 面值

央行发行数字货币：
1. 【100 signed by central bank】，【50 signed by central bank】
    1. 发行的数字货币都有央行的私钥的签名，公钥默认大家都知道
    2. 那么在使用的时候就可以验证是否是央行发行的
    3. 这里只使用的密码学中的公私钥体系，没有使用区块链
2. 但是上述方案是有问题的：
    1. 最大的问题是这个数字货币是可以复制的（文件是可以复制的）
    2. 这个复制的方法就叫做 double spending attack 双花攻击
    3. 数字货币的主要问题就是防范 double spendig attack
3. 如果我们换一种方法：
    1. 【100 signed by cental bank index】
    2. 然后在央行中存放一个数字货币的编码的持有人信息
    3. 这个方案的问题是：太麻烦了，任何两个人支付都要通过央行，中心化方案
4. 去中心化方案：
    1. 数字货币的发行
    2. 怎么验证交易的有效性
5. 谁来发行货币：
    1. 挖矿来决定的，之后说明


怎么验证交易的有效性
1. 假设 A 有发行货币的权利（铸币权），create coin A(10)
2. A 转给 B 和 C，每个人 5 btc：A -> B(5), A -> C(5)
3. 除了 A 的签名，还需要每个 btc 的来源，铸币 - A给予
4. 比特币每笔交易都需要有输入输出，输入是币的来源，输入是收款人公钥的哈希
5. B -> C(2), B -> D(3)，B的签名，来源是 A 给 B 的交易所得
6. C -> E(1)，C 的签名，来源是两个从 B 给 C，5 个是从 A 给 C
7. 第一种是连接各个区块之间的哈希指针
8. 第二种是哈希指针是指向前面某个交易的，币的来源，从而防止币被 double spending，不是凭空捏造的币
9. 再仔细看转账交易：需要有转账人的签名，和收款人的地址（B的地址就是B的公钥再做转换）
10. 付款人如何知道收款人的地址：从公钥来知道，那么A如何知道B的银行账号，B要告诉A，比特币系统是类似的
11. 比特币系统没办法查询公钥，所以很多比特币的地址就是一个二维码，可以扫码获取
12. 要写到区块链之前，需要符合一定条件：A 需要证明自己有足够的钱，B 要知道 A 的公钥，也就是说 B 要知道是否是 A 转给了 B，其实所有节点都需要知道 A 的公钥，每个节点都要独立验证。
13. 如何知道 A 的公钥？